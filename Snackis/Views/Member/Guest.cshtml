@model Entities
@{
	ViewData["Title"] = "Guest";	
}
<div class="three-in-row">
	<div style="display: flex; width: 20rem;">
	</div>



	<div style="display: flex; flex-direction:column; align-items:center; width: 80%;">
		<h1>@ViewData["Title"] Page</h1>
		<br />

		<img src="@Model.Member.ProfileImagePath" alt="Profile picture" style="width:150px;height:150px;object-fit:cover;" />
		<br />
		<br />

		<p><b>First name: </b>@Model.Member.FirstName</p>
		<p><b>Last name: </b>@Model.Member.LastName</p>
		<p><b>Age: </b>@Model.Member.Age</p>		
		<br />
		<p><b>Username: </b>@Model.Member.UserName</p>
		<p><b>Views on profile: </b>@Model.Member.MemberViews.Count()</p>
		<p><b>Member since: </b></p>
		<p style="margin-top: -1rem;">@Model.Member.RegisteryDate</p>
		<br />
		<p><b>Total post: </b>@Model.Member.TotalPosts</p>
		<p><b>Total replies: </b>@Model.Member.TotalReply</p>
		<br />
		<input type="button" class="btn btn-primary" value="Start chatt" onclick="document.getElementById('conversationBox').style.display = 'block'" style=" background-color: cornflowerblue" />
		<div id="conversationBox" style="
                  display:none;
                  position:fixed;
                  top:20%;
                  left:40%;
                  transform:translate(-50%, -50%);
                  background:#fff;
                  padding:1rem;
                  border:1px solid #ccc;
                  border-radius:8px;
                  box-shadow:0 4px 12px rgba(0,0,0,0.2);
                  z-index:1000;
                  max-width:400px;
                  width:90%;
                ">
			<header class="conversation-box__header" aria-label="Skapa konversation" style="display:flex; flex-direction: row; justify-content:space-between;">
				<h3 style="margin:0;font-size:1rem;">Create Conversation</h3>
				<button type="button" class="conversation-box__close btn btn-primary" aria-label="Stäng" style="background:red;" onclick="this.closest('#conversationBox').style.display='none'">✕</button>
			</header>

			<form asp-controller="Member" asp-action="CreateChatt">

				<input type="hidden" asp-for="@Model.Chat.SenderId" value="@Context.Session.GetInt32("UserId")" />
				<input type="hidden" asp-for="@Model.Chat.ReceiverId" value="@Model.Member.Id" />				

				<label for="conversationText" style="display:block;margin:0.5rem 0 0.25rem;font-size:.9rem;">Text to Member</label>
				<input type="text" asp-for="@Model.Chat.Text"
					   id="conversationText"
					   placeholder="Chatt message here.."
					   required
					   style="width:100%;box-sizing:border-box;padding:.5rem;border:1px solid #ccc;border-radius:6px;" />

				<input type="hidden" asp-for="@Model.Chat.SenderId" value="@Model.Member.Id" />

				<div style="display:flex;gap:.5rem;margin-top:.75rem;justify-content:flex-end;">
					<button type="submit" class="conversation-box__create btn btn-primary" style="padding:.5rem .75rem;border-radius:6px;border:1px solid #2b6cb0;background:#2b6cb0;color:#fff;">
						Create
					</button>
				</div>
			</form>
		</div>
	</div>

	<div style="display: flex; width: 20rem; flex-direction:column;">
		<p>
			<b>Info</b>
			<br />
			@Model.Member.UserInfo
		</p>
		@if (Model.Admin != null)
		{
			<br />
			<br />
			<br />
			<br />
			<br />
			<br />

			if (Model.Admin.Id == Context.Session.GetInt32("UserId"))
			{
				<p>Warnings on profile: @Model.Member.Reports</p>
				<a asp-controller="Member" asp-action="memberWarning" asp-route-id="@Model.Member.Id"><button type="Submit" class="btn btn-primary" style="width: 8rem;">Warn Member</button></a>

			}
			if (Model.Admin.IsOwner)
			{
				<br />
				<br />
				<br />
				<form asp-controller="Member" asp-action="MakeAdmin">
					<input type="hidden" id="Id" name="Id" value="@Model.Member.Id">
					<p>
						Make this user an Admin:
						<input type="checkbox" id="IsAdmin" name="IsAdmin" value="true" @(Model.Member.IsAdmin ? " checked" : "") />
					</p>
					<button type="submit" class="btn btn-primary">Submit</button>
				</form>
				<br />
				<br />
				<form asp-controller="Member" asp-action="DeleteUser">
					<input type="hidden" name="userIdToRemove" value="@Model.Member.Id" />

					<button type="submit" class="btn btn-primary" style="background:red; color:black;">Delete User</button>
				</form>
			}

		}
	</div>
</div>